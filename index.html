<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Salt Lake County Housing Analysis</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom CSS -->
  <link href="style.css" rel="stylesheet">
  <!-- PapaParse for CSV parsing -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
</head>
<body class="bg-light">
  <div class="container py-5">
    <header class="mb-4 text-center">
      <h1 class="text-primary fw-bold">Salt Lake County Housing Market Analysis</h1>
      <p class="lead">Data analysis using Python, Pandas, and Matplotlib</p>
    </header>

    <section class="mb-5">
      <h2 class="h4">Charts</h2>
      <div class="row">
        <div class="col-md-6 mb-3 text-center">
          <img src="outputs/price_trend.png" alt="Price Trend Over Time" class="img-fluid rounded shadow">
          <p class="text-muted mt-2">Average Housing Price by Sale Year</p>
        </div>
        <div class="col-md-6 mb-3 text-center">
          <img src="outputs/price_vs_sqft.png" alt="Price vs. Square Feet" class="img-fluid rounded shadow">
          <p class="text-muted mt-2">Price vs. Square Feet Scatter Plot</p>
        </div>
      </div>
    </section>

    <section class="mb-5">
      <h2 class="h4">Average Price by Year Built</h2>
      <div class="table-responsive">
        <table class="table table-striped table-hover shadow-sm" id="year-built-table">
          <thead class="table-dark">
        <tr>
          <th scope="col">Year Built</th>
          <th scope="col">Average Price</th>
        </tr>
        </thead>
        <tbody></tbody>
    </table>
    </div>
    </section>

    <section>
      <h2 class="h4">Average Price by Sale Year</h2>
      <div class="table-responsive">
        <table class="table table-striped table-hover shadow-sm" id="sale-year-table">
          <thead class="table-dark">
            <tr>
              <th scope="col">Sale Year</th>
              <th scope="col">Average Price</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>
  </div>

  <script>
    // Load and display avg_price_by_year_built.csv
    Papa.parse("outputs/avg_price_by_year_built.csv", {
      download: true,
      header: true,
      complete: function(results) {
        const tbody = document.querySelector("#year-built-table tbody");

        const rows = results.data.filter(r => r.year_built && r.AveragePrice);
        // Filter for 2014â€“2024 explicitly
        const filtered = rows.filter(r => {
          const y = parseInt(r.year_built, 10);
          return y >= 2014 && y <= 2024;
        });

        filtered.forEach(row => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${parseInt(row.year_built, 10)}</td>
            <td>$${parseFloat(row.AveragePrice).toLocaleString()}</td>
          `;
          tbody.appendChild(tr);
        });
      }
    });

    // Load and display avg_price_by_sale_year.csv
    Papa.parse("outputs/avg_price_by_sale_year.csv", {
      download: true,
      header: true,
      complete: function(results) {
        const tbody = document.querySelector("#sale-year-table tbody");
        results.data.forEach(row => {
          if(row.SaleYear && row.AveragePrice) {
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${row.SaleYear}</td>
              <td>$${parseFloat(row.AveragePrice).toLocaleString()}</td>
            `;
            tbody.appendChild(tr);
          }
        });
      }
    });
  </script>
</body>
</html>
